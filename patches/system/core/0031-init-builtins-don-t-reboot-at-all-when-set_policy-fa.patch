From f3245649d184c448acca4337cd78f3c8dfc8df02 Mon Sep 17 00:00:00 2001
From: Simao Gomes Viana <xdevs23@outlook.com>
Date: Tue, 2 Jan 2018 22:09:58 +0100
Subject: [PATCH 31/40] init: builtins: don't reboot at all when set_policy
 fails

---
 init/builtins.cpp | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)

diff --git a/init/builtins.cpp b/init/builtins.cpp
index 0ae530e48..8d679a512 100644
--- a/init/builtins.cpp
+++ b/init/builtins.cpp
@@ -273,13 +273,7 @@ static int do_mkdir(const std::vector<std::string>& args) {
     }
 
     if (e4crypt_is_native()) {
-        if (e4crypt_set_directory_policy(args[1].c_str())) {
-            const std::vector<std::string> options = {
-                "--prompt_and_wipe_data",
-                "--reason=set_policy_failed:"s + args[1]};
-            reboot_into_recovery(options);
-            return 0;
-        }
+        e4crypt_set_directory_policy(args[1].c_str());
     }
     return 0;
 }
-- 
2.11.0

