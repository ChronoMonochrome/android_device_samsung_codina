From 59a91459547676a56e18798669a850705ac2eaab Mon Sep 17 00:00:00 2001
From: Simao Gomes Viana <xdevs23@outlook.com>
Date: Tue, 2 Jan 2018 22:09:58 +0100
Subject: [PATCH] init: builtins: don't reboot at all when set_policy fails

diff --git a/init/builtins.cpp b/init/builtins.cpp
index 1fbf0c581..8b5dd7e12 100644
--- a/init/builtins.cpp
+++ b/init/builtins.cpp
@@ -273,13 +273,7 @@ static int do_mkdir(const std::vector<std::string>& args) {
     }
 
     if (e4crypt_is_native()) {
-        if (e4crypt_set_directory_policy(args[1].c_str())) {
-            const std::vector<std::string> options = {
-                "--prompt_and_wipe_data",
-                "--reason=set_policy_failed:"s + args[1]};
-            reboot_into_recovery(options);
-            return 0;
-        }
+        e4crypt_set_directory_policy(args[1].c_str());
     }
     return 0;
 }
