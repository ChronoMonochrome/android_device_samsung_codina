From b59b55632004982133e27c3467118c8b2ec82c1a Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Thu, 4 May 2017 10:26:25 +0300
Subject: [PATCH 14/25] system-core_WW05-Dont-go-busy-loop.patch

Change-Id: I7c3fa88b6de67a4619e5af778941c5e1ff2f3bc4
---
 logwrapper/logwrap.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/logwrapper/logwrap.c b/logwrapper/logwrap.c
index 28d6de7..ccbe0bf 100644
--- a/logwrapper/logwrap.c
+++ b/logwrapper/logwrap.c
@@ -408,7 +408,7 @@ static int parent(const char *tag, int parent_read, pid_t pid,
         if (poll_fds[0].revents & POLLHUP) {
             int ret;
 
-            ret = waitpid(pid, &status, WNOHANG);
+            ret = TEMP_FAILURE_RETRY(waitpid(pid, &status, 0));
             if (ret < 0) {
                 rc = errno;
                 ALOG(LOG_ERROR, "logwrap", "waitpid failed with %s\n", strerror(errno));
-- 
2.5.0

