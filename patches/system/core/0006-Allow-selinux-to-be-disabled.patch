From 2ad5de8905572e009a66b3b980c05aa8db8d923f Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Sat, 12 Mar 2016 15:04:02 +0700
Subject: [PATCH 6/6] Allow selinux to be disabled

---
 init/Android.mk | 4 ----
 init/init.cpp   | 5 +----
 2 files changed, 1 insertion(+), 8 deletions(-)

diff --git a/init/Android.mk b/init/Android.mk
index 66ce8a8..6fa5a0b 100644
--- a/init/Android.mk
+++ b/init/Android.mk
@@ -4,11 +4,7 @@ LOCAL_PATH:= $(call my-dir)
 
 # --
 
-ifneq (,$(filter userdebug eng,$(TARGET_BUILD_VARIANT)))
 init_options += -DALLOW_LOCAL_PROP_OVERRIDE=1 -DALLOW_PERMISSIVE_SELINUX=1
-else
-init_options += -DALLOW_LOCAL_PROP_OVERRIDE=0 -DALLOW_PERMISSIVE_SELINUX=0
-endif
 
 init_options += -DLOG_UEVENTS=0
 
diff --git a/init/init.cpp b/init/init.cpp
index 5712e26..7141780 100644
--- a/init/init.cpp
+++ b/init/init.cpp
@@ -454,10 +454,7 @@ static selinux_enforcing_status selinux_status_from_cmdline() {
 
 static bool selinux_is_enforcing(void)
 {
-    if (ALLOW_PERMISSIVE_SELINUX) {
-        return selinux_status_from_cmdline() == SELINUX_ENFORCING;
-    }
-    return true;
+    return false;
 }
 
 int selinux_reload_policy(void)
-- 
2.5.0

