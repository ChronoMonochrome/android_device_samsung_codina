From a7f7fc36b22f5eddf8b7d525c310758ba8f7907d Mon Sep 17 00:00:00 2001
From: DarkLord1731 <darklord1731@gmail.com>
Date: Mon, 25 Jun 2018 09:22:17 +0530
Subject: [PATCH] libril: Force static radio capability

Force the ril to return REQUEST_NOT_SUPPORTED error on getRadioCapability request.
Android handles the error and makes static radio capability for us, based on our config_radio_access_family overlay.

* Fixes network mode switch

diff --git a/libril/ril_service.cpp b/libril/ril_service.cpp
index 3bb3d5f..c5a3446 100644
--- a/libril/ril_service.cpp
+++ b/libril/ril_service.cpp
@@ -2657,7 +2657,8 @@ Return<void> RadioImpl::getRadioCapability(int32_t serial) {
 #if VDBG
     RLOGD("getRadioCapability: serial %d", serial);
 #endif
-    dispatchVoid(serial, mSlotId, RIL_REQUEST_GET_RADIO_CAPABILITY);
+    RequestInfo *pRI = android::addRequestToList(serial, mSlotId, RIL_REQUEST_GET_RADIO_CAPABILITY);
+    sendErrorResponse(pRI, RIL_E_REQUEST_NOT_SUPPORTED);
     return Void();
 }
 
