From fb6168d5848b222b0a78acfc4936a12f4e363026 Mon Sep 17 00:00:00 2001
From: mickybart <mickybart@pygoscelis.org>
Date: Sat, 19 Nov 2016 19:05:05 -0500
Subject: [PATCH] StrictMode and files under

/storage/sdcard1/
/storage/sdcard0/
android.os.FileUriExposedException: file:///storage/sdcard1/Downloads/taskmanager.ver.2.8.2.4.apk
at android.os.StrictMode.onFileUriExposed(StrictMode.java:1799)
at android.net.Uri.checkFileUriExposed(Uri.java:2346)

diff --git a/core/java/android/net/Uri.java b/core/java/android/net/Uri.java
index f76a683..ad550e8 100644
--- a/core/java/android/net/Uri.java
+++ b/core/java/android/net/Uri.java
@@ -2352,7 +2352,8 @@ public Uri getCanonicalUri() {
      */
     public void checkFileUriExposed(String location) {
         if ("file".equals(getScheme())
-                && (getPath() != null) && !getPath().startsWith("/system/")) {
+                && (getPath() != null) && !(getPath().startsWith("/system/")
+                || getPath().startsWith("/storage/") || getPath().startsWith("/data/"))) {
             StrictMode.onFileUriExposed(this, location);
         }
     }
