From edefcc0e69ecc761cd33bde523236ea12db63dcc Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 25 Jan 2016 02:33:49 +0700
Subject: [PATCH 47/64] Revert "Navbar: legacy menu key toggle"

This reverts commit e3b1651bd2e7681c8692777636cbae18812b01ad.

Change-Id: I04d095f399998e9b546658d5554ba73ef0d4b16a
---
 core/java/android/provider/Settings.java           | 12 -----
 .../statusbar/phone/NavigationBarView.java         | 56 ++++++++--------------
 2 files changed, 20 insertions(+), 48 deletions(-)

diff --git a/core/java/android/provider/Settings.java b/core/java/android/provider/Settings.java
index 03e5127..f395410 100755
--- a/core/java/android/provider/Settings.java
+++ b/core/java/android/provider/Settings.java
@@ -3324,18 +3324,6 @@ public final class Settings {
         public static final String ENABLE_NAVIGATION_BAR = "enable_navigation_bar";
 
         /**
-         * Allow navigation bar side keys
-         * @hide
-         */
-        public static final String NAVIGATION_BAR_SIDEKEYS = "navigation_bar_sidekeys";
-
-        /**
-         * Allow navigation bar IME arrow keys
-         * @hide
-         */
-        public static final String NAVIGATION_BAR_ARROWS = "navigation_bar_arrows";
-
-        /**
          * Whether or not to enable the navring
          * @hide
          */
diff --git a/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java b/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java
index 2eba775..c671604 100644
--- a/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java
+++ b/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java
@@ -108,7 +108,6 @@ public class NavigationBarView extends LinearLayout {
     private boolean mPrefNavring;
     private boolean mPrefLockscreen;
     private String mUserButtons;
-    private boolean mSideKeys;
 
     // workaround for LayoutTransitions leaving the nav buttons in a weird state (bug 5549288)
     final static boolean WORKAROUND_INVALID_LAYOUT = true;
@@ -552,14 +551,11 @@ public class NavigationBarView extends LinearLayout {
                 @Override
                 public void onChange(boolean selfChange) {
                     mUserButtons = Settings.System.getString(r, Settings.System.NAVIGATION_BAR_BUTTONS);
-                    mSideKeys = Settings.System.getInt(r, Settings.System.NAVIGATION_BAR_SIDEKEYS, 1) == 1;
                     setupNavigationButtons();
                 }};
 
             r.registerContentObserver(Settings.System.getUriFor(Settings.System.NAVIGATION_BAR_BUTTONS),
                 false, mSettingsObserver);
-            r.registerContentObserver(Settings.System.getUriFor(Settings.System.NAVIGATION_BAR_SIDEKEYS),
-                false, mSettingsObserver);
         }
 
         if (mDisablePrefsObserver == null) {
@@ -661,21 +657,17 @@ public class NavigationBarView extends LinearLayout {
             lightsOut.removeAllViews();
 
             if (mTablet) {
-                if (mSideKeys) {
-                    // offset menu button
-                    addSeparator(navButtons, landscape, (int) mMenuButtonWidth, 0f);
-                    addSeparator(lightsOut, landscape, (int) mMenuButtonWidth, 0f);
-
-                    // eats up that extra mTablet space
-                    addSeparator(navButtons, landscape, 0, stockThreeButtonLayout ? 1f : 0.5f);
-                    addSeparator(lightsOut, landscape, 0, stockThreeButtonLayout ? 1f : 0.5f);
-                }
+                // offset menu button
+                addSeparator(navButtons, landscape, (int) mMenuButtonWidth, 0f);
+                addSeparator(lightsOut, landscape, (int) mMenuButtonWidth, 0f);
+
+                // eats up that extra mTablet space
+                addSeparator(navButtons, landscape, 0, stockThreeButtonLayout ? 1f : 0.5f);
+                addSeparator(lightsOut, landscape, 0, stockThreeButtonLayout ? 1f : 0.5f);
             } else {
-                if (mSideKeys) {
-                    // on phone ui this offsets the right side menu button
-                    addSeparator(navButtons, landscape, separatorSize, 0f);
-                    addSeparator(lightsOut, landscape, separatorSize, 0f);
-                }
+                // on phone ui this offsets the right side menu button
+                addSeparator(navButtons, landscape, separatorSize, 0f);
+                addSeparator(lightsOut, landscape, separatorSize, 0f);
             }
 
             for (int j = 0; j < mNavButtons.size(); j++) {
@@ -732,11 +724,7 @@ public class NavigationBarView extends LinearLayout {
             menuButton.setLayoutParams(getLayoutParams(landscape, mMenuButtonWidth, 0f));
             menuButton.setGlowBackground(landscape ? R.drawable.ic_sysbar_highlight_land
                     : R.drawable.ic_sysbar_highlight);
-            if (mSideKeys) {
-                menuButton.setVisibility(mShowMenu ? View.VISIBLE : View.INVISIBLE);
-            } else {
-                menuButton.setVisibility(View.GONE);
-            }
+            menuButton.setVisibility(mShowMenu ? View.VISIBLE : View.INVISIBLE);
             if (mMenuButtonId == 0) {
                 // assign the same id for layout and horizontal buttons
                 mMenuButtonId = View.generateViewId();
@@ -745,20 +733,16 @@ public class NavigationBarView extends LinearLayout {
             // MENU BUTTON NOT YET ADDED ANYWHERE!
 
             if (mTablet) {
-                if (mSideKeys) {
-                    // om nom
-                    addSeparator(navButtons, landscape, 0,  stockThreeButtonLayout ? 1f : 0.5f);
-                    addSeparator(lightsOut, landscape, 0,  stockThreeButtonLayout ? 1f : 0.5f);
-
-                    // add the button last so it hangs on the edge
-                    addButton(navButtons, menuButton, landscape);
-                    addLightsOutButton(lightsOut, menuButton, landscape, true);
-                }
+                // om nom
+                addSeparator(navButtons, landscape, 0,  stockThreeButtonLayout ? 1f : 0.5f);
+                addSeparator(lightsOut, landscape, 0,  stockThreeButtonLayout ? 1f : 0.5f);
+
+                // add the button last so it hangs on the edge
+                addButton(navButtons, menuButton, landscape);
+                addLightsOutButton(lightsOut, menuButton, landscape, true);
             } else {
-                if (mSideKeys) {
-                    addButton(navButtons, menuButton, landscape);
-                    addLightsOutButton(lightsOut, menuButton, landscape, true);
-                }
+                addButton(navButtons, menuButton, landscape);
+                addLightsOutButton(lightsOut, menuButton, landscape, true);
             }
         }
         invalidate();
-- 
2.5.0

