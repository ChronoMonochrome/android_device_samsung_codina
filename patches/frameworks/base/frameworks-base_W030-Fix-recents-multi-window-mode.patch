From 4392195282cd3cc08e0a0cc575a1664a23bde631 Mon Sep 17 00:00:00 2001
From: SpiritCroc <spiritcroc@gmail.com>
Date: Sun, 4 Jun 2017 20:25:56 +0200
Subject: [PATCH] Fix empty recents view in multi window mode

An empty recents view will be launched if recents become
visible and another visible task is the resumed (top) task.

Fix this by reloading tasks in onStart.

diff --git a/packages/SystemUI/src/com/android/systemui/recents/RecentsActivity.java b/packages/SystemUI/src/com/android/systemui/recents/RecentsActivity.java
index ba3bcc7..88a06c4 100644
--- a/packages/SystemUI/src/com/android/systemui/recents/RecentsActivity.java
+++ b/packages/SystemUI/src/com/android/systemui/recents/RecentsActivity.java
@@ -411,6 +411,10 @@ protected void onStart() {
         // Notify of the next draw
         mRecentsView.getViewTreeObserver().addOnPreDrawListener(mRecentsDrawnEventListener);
 
+        if (isInMultiWindowMode()) {
+             reloadTaskStack(true /* isInMultiWindowMode */, false /* sendConfigChangedEvent */);
+        }
+
         // If Recents was restarted, then it should complete the enter animation with partially
         // reset launch state with dock, app and home set to false
         Object isRelaunching = getLastNonConfigurationInstance();
