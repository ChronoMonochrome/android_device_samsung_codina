From b2649a6ff99e19d108a7a69009e10357c0996c9c Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 25 Jan 2016 01:09:27 +0700
Subject: [PATCH 18/64] Revert "AwesomeAction: remove duplicate string
 comparison"

This reverts commit 5e4ff8eb1378ee099bbd8b6b83c7e6b06f82f383.
---
 .../android/internal/util/aokp/AwesomeAction.java  | 47 ++++++++++++----------
 1 file changed, 25 insertions(+), 22 deletions(-)

diff --git a/core/java/com/android/internal/util/aokp/AwesomeAction.java b/core/java/com/android/internal/util/aokp/AwesomeAction.java
index a0f48dc..f680b93 100755
--- a/core/java/com/android/internal/util/aokp/AwesomeAction.java
+++ b/core/java/com/android/internal/util/aokp/AwesomeAction.java
@@ -60,6 +60,7 @@ import com.android.internal.util.cm.ActionUtils;
 public class AwesomeAction {
 
     public static final String TAG = "AwesomeAction";
+    public static final String NULL_ACTION = AwesomeConstant.ACTION_NULL.value();
 
     private static final int LAYOUT_LEFT = -1;
     private static final int LAYOUT_RIGHT = 1;
@@ -77,7 +78,11 @@ public class AwesomeAction {
     }
 
     public static boolean launchAction(final Context mContext, final String action) {
+        if (TextUtils.isEmpty(action) || action.equals(NULL_ACTION)) {
+            return false;
+        }
         AwesomeConstant AwesomeEnum = fromString(action);
+        AudioManager am;
         switch (AwesomeEnum) {
             case ACTION_HOME:
                 IWindowManager mWindowManagerService = WindowManagerGlobal.getWindowManagerService();
@@ -117,7 +122,6 @@ public class AwesomeAction {
                 if (isIntentAvailable(mContext, intent))
                     mContext.startActivity(intent);
                 break;
-
             case ACTION_VOICEASSIST:
                 Intent intentVoice = new Intent(RecognizerIntent.ACTION_WEB_SEARCH);
                 intentVoice.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
@@ -168,6 +172,9 @@ public class AwesomeAction {
                 mContext.sendBroadcast(appWindow);
                 break;
 
+            case ACTION_BLANK:
+                break;
+
             case ACTION_ARROW_LEFT:
                 triggerVirtualKeypress(KeyEvent.KEYCODE_DPAD_LEFT, CURSOR_FLAGS);
                 break;
@@ -185,17 +192,17 @@ public class AwesomeAction {
                 break;
 
             case ACTION_RING_VIB:
-                final AudioManager rv = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);
-                if (rv != null) {
-                    if (rv.getRingerMode() != AudioManager.RINGER_MODE_VIBRATE) {
-                        rv.setRingerMode(AudioManager.RINGER_MODE_VIBRATE);
+                am = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);
+                if (am != null) {
+                    if (am.getRingerMode() != AudioManager.RINGER_MODE_VIBRATE) {
+                        am.setRingerMode(AudioManager.RINGER_MODE_VIBRATE);
                         Vibrator vib = (Vibrator) mContext
                                 .getSystemService(Context.VIBRATOR_SERVICE);
                         if (vib != null) {
                             vib.vibrate(50);
                         }
                     } else {
-                        rv.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
+                        am.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
                         ToneGenerator tg = new ToneGenerator(
                                 AudioManager.STREAM_NOTIFICATION,
                                 (int) (ToneGenerator.MAX_VOLUME * 0.85));
@@ -228,12 +235,12 @@ public class AwesomeAction {
                 break;
 
             case ACTION_RING_SILENT:
-                final AudioManager rs = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);
-                if (rs != null) {
-                    if (rs.getRingerMode() != AudioManager.RINGER_MODE_SILENT) {
-                        rs.setRingerMode(AudioManager.RINGER_MODE_SILENT);
+                am = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);
+                if (am != null) {
+                    if (am.getRingerMode() != AudioManager.RINGER_MODE_SILENT) {
+                        am.setRingerMode(AudioManager.RINGER_MODE_SILENT);
                     } else {
-                        rs.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
+                        am.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
                         ToneGenerator tg = new ToneGenerator(
                                 AudioManager.STREAM_NOTIFICATION,
                                 (int) (ToneGenerator.MAX_VOLUME * 0.85));
@@ -245,19 +252,19 @@ public class AwesomeAction {
                 break;
 
             case ACTION_RING_VIB_SILENT:
-                final AudioManager rvs = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);
-                if (rvs != null) {
-                    if (rvs.getRingerMode() == AudioManager.RINGER_MODE_NORMAL) {
-                        rvs.setRingerMode(AudioManager.RINGER_MODE_VIBRATE);
+                am = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);
+                if (am != null) {
+                    if (am.getRingerMode() == AudioManager.RINGER_MODE_NORMAL) {
+                        am.setRingerMode(AudioManager.RINGER_MODE_VIBRATE);
                         Vibrator vib = (Vibrator) mContext
                                 .getSystemService(Context.VIBRATOR_SERVICE);
                         if (vib != null) {
                             vib.vibrate(50);
                         }
-                    } else if (rvs.getRingerMode() == AudioManager.RINGER_MODE_VIBRATE) {
-                        rvs.setRingerMode(AudioManager.RINGER_MODE_SILENT);
+                    } else if (am.getRingerMode() == AudioManager.RINGER_MODE_VIBRATE) {
+                        am.setRingerMode(AudioManager.RINGER_MODE_SILENT);
                     } else {
-                        rvs.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
+                        am.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
                         ToneGenerator tg = new ToneGenerator(
                                 AudioManager.STREAM_NOTIFICATION,
                                 (int) (ToneGenerator.MAX_VOLUME * 0.85));
@@ -271,10 +278,6 @@ public class AwesomeAction {
             case ACTION_GESTURE_ACTIONS:
                 mContext.sendBroadcast(new Intent(Intent.TOGGLE_GESTURE_ACTIONS));
                 break;
-
-            case ACTION_NULL:
-            case ACTION_BLANK:
-                break;
         }
         return true;
     }
-- 
2.5.0

