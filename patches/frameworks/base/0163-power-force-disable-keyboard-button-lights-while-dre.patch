From a68e09a633f9efdedf2cd15f110cdd86e702fde9 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 20 Aug 2018 22:57:43 +0300
Subject: [PATCH 163/296] power: force-disable keyboard/button-lights while
 dreaming

---
 .../core/java/com/android/server/power/PowerManagerService.java     | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/services/core/java/com/android/server/power/PowerManagerService.java b/services/core/java/com/android/server/power/PowerManagerService.java
index 38d092a1e09..92b0a51e9cf 100644
--- a/services/core/java/com/android/server/power/PowerManagerService.java
+++ b/services/core/java/com/android/server/power/PowerManagerService.java
@@ -2358,6 +2358,12 @@ public final class PowerManagerService extends SystemService
                 return; // wait for next cycle
             }
 
+            // keep keyboard/buttons dark if we are dreaming
+            if (wakefulness == WAKEFULNESS_DREAMING ||
+                 wakefulness == WAKEFULNESS_DOZING) {
+                 mButtonsLight.setBrightness(0);
+            }
+
             // Determine whether the dream should continue.
             if (wakefulness == WAKEFULNESS_DREAMING) {
                 if (isDreaming && canDreamLocked()) {
-- 
2.11.0

