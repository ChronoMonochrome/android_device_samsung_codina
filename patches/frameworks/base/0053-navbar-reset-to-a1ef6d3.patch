From d7a43d55e84efe9db0125c3351632ba36e944a6a Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 25 Jan 2016 02:44:58 +0700
Subject: [PATCH 53/64] navbar: reset to a1ef6d3

Change-Id: I39ec4e4bad81097e77c038b08c8b7eb6feebe81c
---
 .../systemui/statusbar/phone/NavigationBarView.java     | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java b/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java
index 7a43338..c47fb7f 100644
--- a/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java
+++ b/packages/SystemUI/src/com/android/systemui/statusbar/phone/NavigationBarView.java
@@ -90,7 +90,7 @@ public class NavigationBarView extends LinearLayout {
     private float mButtonWidth, mMenuButtonWidth;
     private int mMenuButtonId;
 
-    final boolean mTablet = isTablet(mContext);
+    final boolean mTablet = isTablet(getContext());
 
     private ArrayList<AwesomeButtonInfo> mNavButtons = new ArrayList<AwesomeButtonInfo>();
 
@@ -450,11 +450,11 @@ public class NavigationBarView extends LinearLayout {
                         Settings.System.ENABLE_NAVIGATION_RING, 1) == 1;
         final boolean showCamera = showSearch && !mCameraDisabledByDpm
                 && mLockUtils.getCameraEnabled();
-        final boolean showNotifs = disableHome && !disableSearch &&
+        final boolean showNotifs = showSearch &&
             Settings.System.getInt(mContext.getContentResolver(),
-                    Settings.System.LOCKSCREEN_NOTIFICATIONS, 0) == 1
+                    Settings.System.LOCKSCREEN_NOTIFICATIONS, 1) == 1
             && Settings.System.getInt(mContext.getContentResolver(),
-                    Settings.System.ACTIVE_NOTIFICATIONS, 0) == 1
+                    Settings.System.ACTIVE_NOTIFICATIONS, 1) == 1
             && Settings.System.getInt(mContext.getContentResolver(),
                     Settings.System.ACTIVE_NOTIFICATIONS_PRIVACY_MODE, 0) == 0;
 
@@ -570,7 +570,7 @@ public class NavigationBarView extends LinearLayout {
         }
     }
 
-    private void setupNavigationButtons() {
+    private void updateUserConfig() {
         mNavButtons.clear();
 
         if (mUserButtons == null || mUserButtons.isEmpty()) {
@@ -607,7 +607,10 @@ public class NavigationBarView extends LinearLayout {
                 }
             }
         }
+    }
 
+    private void setupNavigationButtons() {
+        updateUserConfig();
         final boolean stockThreeButtonLayout = mNavButtons.size() == 3;
         int separatorSize = (int) mMenuButtonWidth;
 
@@ -641,7 +644,7 @@ public class NavigationBarView extends LinearLayout {
             for (int j = 0; j < mNavButtons.size(); j++) {
                 // create the button
                 AwesomeButtonInfo info = mNavButtons.get(j);
-                KeyButtonView button = new KeyButtonView(mContext, null);
+                KeyButtonView button = new KeyButtonView(getContext(), null);
                 button.setButtonActions(info);
                 if (mTablet) {
                     if (mNavButtons.size() <= 4) {
@@ -686,7 +689,7 @@ public class NavigationBarView extends LinearLayout {
             // legacy menu button
             AwesomeButtonInfo menuButtonInfo = new AwesomeButtonInfo(AwesomeConstant.ACTION_MENU.value(),
                     null, null, null);
-            KeyButtonView menuButton = new KeyButtonView(mContext, null);
+            KeyButtonView menuButton = new KeyButtonView(getContext(), null);
             menuButton.setButtonActions(menuButtonInfo);
             menuButton.setImageResource(R.drawable.ic_sysbar_menu);
             menuButton.setLayoutParams(getLayoutParams(landscape, mMenuButtonWidth, 0f));
-- 
2.5.0

