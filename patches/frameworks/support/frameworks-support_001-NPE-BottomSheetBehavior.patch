From 50d43b5884ebcb4e0ac579ee29856e1b60d2b185 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Geoffrey=20M=C3=A9tais?= <geoffrey.metais@gmail.com>
Date: Tue, 14 Feb 2017 10:29:35 +0100
Subject: [PATCH] Prevent a NPE in BottomSheetBehavior

diff --git a/design/src/android/support/design/widget/BottomSheetBehavior.java b/design/src/android/support/design/widget/BottomSheetBehavior.java
index aaa9b8046..a807f4131 100644
--- a/design/src/android/support/design/widget/BottomSheetBehavior.java
+++ b/design/src/android/support/design/widget/BottomSheetBehavior.java
@@ -296,7 +296,7 @@ public boolean onInterceptTouchEvent(CoordinatorLayout parent, V child, MotionEv
         // We have to handle cases that the ViewDragHelper does not capture the bottom sheet because
         // it is not the top most view of its parent. This is not necessary when the touch event is
         // happening over the scrolling content as nested scrolling logic handles that case.
-        View scroll = mNestedScrollingChildRef.get();
+        View scroll = mNestedScrollingChildRef != null ? mNestedScrollingChildRef.get() : null;
         return action == MotionEvent.ACTION_MOVE && scroll != null &&
                 !mIgnoreEvents && mState != STATE_DRAGGING &&
                 !parent.isPointInChildBounds(scroll, (int) event.getX(), (int) event.getY()) &&
