From cb31acb5b83f74b52c829e6a8463778ebd6f6f9d Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Sun, 24 May 2015 21:13:49 +0300
Subject: [PATCH 3/4] 0004-patch-for-binder.patch

Change-Id: I5f6c43ea836cd3874cf922f166d993bf5bdf9090
---
 libs/binder/MemoryBase.cpp | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/libs/binder/MemoryBase.cpp b/libs/binder/MemoryBase.cpp
index 04565c6..e6d6401 100644
--- a/libs/binder/MemoryBase.cpp
+++ b/libs/binder/MemoryBase.cpp
@@ -63,3 +63,11 @@ sp<IMemoryHeap> android::MemoryBase::getMemory(long* offset, unsigned int* size)
 
 // ---------------------------------------------------------------------------
 }; // namespace android
+
+#ifndef __LP64__
+// Backwards compatibility for libdatabase_sqlcipher (http://b/8253769).
+extern "C" void _ZN7android10MemoryBaseC1ERKNS_2spINS_11IMemoryHeapEEEij(void*, void*, ssize_t, size_t);
+extern "C" void _ZN7android10MemoryBaseC1ERKNS_2spINS_11IMemoryHeapEEElj(void* obj, void* h, long o, unsigned int size) {
+    _ZN7android10MemoryBaseC1ERKNS_2spINS_11IMemoryHeapEEEij(obj, h, o, size);
+}
+#endif
-- 
1.9.1

