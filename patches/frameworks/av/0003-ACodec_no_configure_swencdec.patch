From d2c1b98e13d354e2b2a680c0877fd8166ffa3fec Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Wed, 7 Oct 2015 01:55:17 +0300
Subject: [PATCH 3/7] ACodec_no_configure_swencdec

Change-Id: I5b9979813ac0b4873e2851c42abf1108614335c0
---
 media/libstagefright/ACodec.cpp | 9 +++++++++
 1 file changed, 9 insertions(+)
 mode change 100644 => 100755 media/libstagefright/ACodec.cpp

diff --git a/media/libstagefright/ACodec.cpp b/media/libstagefright/ACodec.cpp
old mode 100644
new mode 100755
index 71b97d0..6760275
--- a/media/libstagefright/ACodec.cpp
+++ b/media/libstagefright/ACodec.cpp
@@ -1629,6 +1629,15 @@ status_t ACodec::configureCodec(
     sp<AMessage> outputFormat = mNotify->dup(); // will use this for kWhatOutputFormatChanged
 
     mIsEncoder = encoder;
+   /* Meticulus:
+    * Software codecs don't require configuration? Not sure
+    * but skipping configuration for them seems to work.
+    */
+    if(strncmp("OMX.google.h264", mComponentName.c_str(), 15) == 0
+       || strncmp("OMX.ffmpeg.h264", mComponentName.c_str(), 15) == 0){
+	ALOGI("Meticulus: Soft codec %s detected, skipping configureCodec\n", mComponentName.c_str());
+       return OK;
+    }
 
     mInputMetadataType = kMetadataBufferTypeInvalid;
     mOutputMetadataType = kMetadataBufferTypeInvalid;
-- 
1.9.1

