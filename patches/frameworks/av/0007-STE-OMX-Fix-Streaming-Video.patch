From 10cc752d43342184adef5e71723cdbd6a4dd4322 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Wed, 7 Oct 2015 01:45:13 +0300
Subject: [PATCH 7/7] STE OMX Fix Streaming Video

Change-Id: Ibb1de39ec904ecfba451f56249f20aa9a2270733
---
 include/camera/CameraParameters.h | 1 +
 media/libstagefright/ACodec.cpp   | 6 +-----
 2 files changed, 2 insertions(+), 5 deletions(-)

diff --git a/include/camera/CameraParameters.h b/include/camera/CameraParameters.h
index 546b7bc..dbe7f1b 100644
--- a/include/camera/CameraParameters.h
+++ b/include/camera/CameraParameters.h
@@ -19,6 +19,7 @@
 
 #include <utils/KeyedVector.h>
 #include <utils/String8.h>
+#include "camera/CameraParametersExtra.h"
 
 namespace android {
 
diff --git a/media/libstagefright/ACodec.cpp b/media/libstagefright/ACodec.cpp
index 6760275..abe13bc 100755
--- a/media/libstagefright/ACodec.cpp
+++ b/media/libstagefright/ACodec.cpp
@@ -769,11 +769,7 @@ status_t ACodec::allocateBuffersOnPort(OMX_U32 portIndex) {
 
     status_t err;
     if (mNativeWindow != NULL && portIndex == kPortIndexOutput) {
-        if (storingMetadataInDecodedBuffers()) {
-            err = allocateOutputMetadataBuffers();
-        } else {
-            err = allocateOutputBuffersFromNativeWindow();
-        }
+        err = allocateOutputBuffersFromNativeWindow();
     } else {
         OMX_PARAM_PORTDEFINITIONTYPE def;
         InitOMXParams(&def);
-- 
1.9.1

