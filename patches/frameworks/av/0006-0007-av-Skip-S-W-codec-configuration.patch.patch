From 78e98c55cef7ea6c1d5974d9ce22b7d339c85b5f Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Wed, 2 Sep 2015 16:03:05 +0300
Subject: [PATCH 6/6] 0007-av-Skip-S-W-codec-configuration.patch

Change-Id: Icaa9bf5a377fe5ed0c93cd451b4184cf834fc8dc
---
 media/libstagefright/ACodec.cpp | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/media/libstagefright/ACodec.cpp b/media/libstagefright/ACodec.cpp
index 12d734a..faac0da 100644
--- a/media/libstagefright/ACodec.cpp
+++ b/media/libstagefright/ACodec.cpp
@@ -1189,6 +1189,14 @@ status_t ACodec::configureCodec(
     sp<AMessage> outputFormat = mNotify->dup(); // will use this for kWhatOutputFormatChanged
 
     mIsEncoder = encoder;
+    /* Meticulus:
+     * Software codecs don't require configuration? Not sure
+     * but skipping configuration for them seems to work.
+     */
+    if(strncmp("OMX.google.h264", mComponentName.c_str(), 15) == 0) {
+        ALOGI("Meticulus: Soft codec %s detected, skipping configureCodec\n", mComponentName.c_str());
+        return OK;
+    }
 
     status_t err = setComponentRole(encoder /* isEncoder */, mime);
 
-- 
1.9.1

