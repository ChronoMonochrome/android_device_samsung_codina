From 02538c2e7dd624ca39f6b583432b1e99cda87613 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Sun, 17 May 2015 00:26:50 +0300
Subject: [PATCH 6/9] 0007-Fix-in-call-audio.patch

Change-Id: Ic6e402e6078470a05c7cce1950e21b57d5c15023
---
 services/audioflinger/AudioFlinger.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/services/audioflinger/AudioFlinger.cpp b/services/audioflinger/AudioFlinger.cpp
index f4f5f0b..bf5da82 100644
--- a/services/audioflinger/AudioFlinger.cpp
+++ b/services/audioflinger/AudioFlinger.cpp
@@ -2150,7 +2150,11 @@ status_t AudioFlinger::openOutput(audio_module_handle_t module,
         thread->audioConfigChanged(AudioSystem::OUTPUT_OPENED);
 
         // the first primary output opened designates the primary hw device
+#ifdef STE_HARDWARE
+        if (mPrimaryHardwareDev == NULL) {
+#else
         if ((mPrimaryHardwareDev == NULL) && (flags & AUDIO_OUTPUT_FLAG_PRIMARY)) {
+#endif
             ALOGI("Using module %d has the primary audio interface", module);
             mPrimaryHardwareDev = thread->getOutput()->audioHwDev;
 
-- 
1.9.1

