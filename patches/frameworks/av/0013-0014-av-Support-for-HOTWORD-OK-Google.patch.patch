From 265d82c5a00b97e1dd81c52490c13b2354d07be2 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Thu, 28 Jan 2016 08:51:43 +0700
Subject: [PATCH 13/58] 0014-av-Support-for-HOTWORD-OK-Google.patch

Change-Id: Iac2b6389be6a1eb738b7560eabb25c595c08cf13
---
 services/audiopolicy/AudioPolicyInterfaceImplLegacy.cpp | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/services/audiopolicy/AudioPolicyInterfaceImplLegacy.cpp b/services/audiopolicy/AudioPolicyInterfaceImplLegacy.cpp
index 5ea90bf..35287b2 100644
--- a/services/audiopolicy/AudioPolicyInterfaceImplLegacy.cpp
+++ b/services/audiopolicy/AudioPolicyInterfaceImplLegacy.cpp
@@ -288,6 +288,12 @@ void AudioPolicyService::releaseInput(audio_io_handle_t input,
         return;
     }
 
+#ifdef HAVE_PRE_KITKAT_AUDIO_BLOB
+    if (inputSource == AUDIO_SOURCE_HOTWORD) {
+        inputSource = AUDIO_SOURCE_VOICE_RECOGNITION;
+    }
+#endif
+
     sp<AudioPolicyEffects>audioPolicyEffects;
     {
         Mutex::Autolock _l(mLock);
-- 
2.5.0

