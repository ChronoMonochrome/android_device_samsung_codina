From f0d8523b8b38a8aab9c378f23a5b716b82a79f12 Mon Sep 17 00:00:00 2001
From: Amit Pundir <amit.pundir@linaro.org>
Date: Sat, 27 Jul 2013 01:42:30 +0530
Subject: [PATCH 41/95] libstagefright: audioflinger: use no strict aliasing
 for now

Change-Id: Ie16c84cd63418800953ee8105b0dc338d87e8aa5
Signed-off-by: Amit Pundir <amit.pundir@linaro.org>
Signed-off-by: Chet Kener <Cl3Kener@gmail.com>
---
 media/libstagefright/Android.mk  | 2 ++
 services/audioflinger/Android.mk | 5 +++++
 2 files changed, 7 insertions(+)

diff --git a/media/libstagefright/Android.mk b/media/libstagefright/Android.mk
index a3efc9d..0004c6d 100644
--- a/media/libstagefright/Android.mk
+++ b/media/libstagefright/Android.mk
@@ -74,6 +74,8 @@ LOCAL_C_INCLUDES:= \
         $(TOP)/external/icu/icu4c/source/common \
         $(TOP)/external/icu/icu4c/source/i18n \
 
+LOCAL_CFLAGS += -fno-strict-aliasing
+
 LOCAL_SHARED_LIBRARIES := \
         libbinder \
         libcamera_client \
diff --git a/services/audioflinger/Android.mk b/services/audioflinger/Android.mk
index f100e6b..80179c1 100644
--- a/services/audioflinger/Android.mk
+++ b/services/audioflinger/Android.mk
@@ -39,6 +39,11 @@ LOCAL_SRC_FILES:=               \
 
 LOCAL_SRC_FILES += StateQueue.cpp
 
+# uncomment for debugging timing problems related to StateQueue::push()
+LOCAL_CFLAGS += -DSTATE_QUEUE_DUMP
+
+LOCAL_CFLAGS += -fno-strict-aliasing
+
 LOCAL_C_INCLUDES := \
     $(TOPDIR)frameworks/av/services/audiopolicy \
     $(call include-path-for, audio-effects) \
-- 
2.5.0

