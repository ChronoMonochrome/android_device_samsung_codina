From 7647a6c9c2ce6f717ec55e7e745ccb3815f18b4a Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 26 Dec 2016 19:45:50 +0700
Subject: [PATCH 34/46] frameworks-av_WW007-Fix-de-referencing-NULL.patch

Change-Id: Icb890aeaa8ceb1044d387f86901b35a7bb95b562
---
 media/libmediaplayerservice/nuplayer/NuPlayer.cpp | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/media/libmediaplayerservice/nuplayer/NuPlayer.cpp b/media/libmediaplayerservice/nuplayer/NuPlayer.cpp
index b0ec5cd..ee7fb9a 100644
--- a/media/libmediaplayerservice/nuplayer/NuPlayer.cpp
+++ b/media/libmediaplayerservice/nuplayer/NuPlayer.cpp
@@ -1604,7 +1604,10 @@ status_t NuPlayer::instantiateDecoder(
     if (*decoder != NULL || (audio && mFlushingAudio == SHUT_DOWN)) {
         return OK;
     }
-
+    if (mSource == NULL) {
+        ALOGD("%s Ignore instantiate decoder after clearing source", __func__);
+        return INVALID_OPERATION;
+    }
     sp<AMessage> format = mSource->getFormat(audio);
 
     if (format == NULL) {
-- 
2.9.3

