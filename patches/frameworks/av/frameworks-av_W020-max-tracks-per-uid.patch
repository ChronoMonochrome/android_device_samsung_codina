From b9980615eff41a5b83f48fa8a97e6bb41f96e640 Mon Sep 17 00:00:00 2001
From: syphyr <syphyr@gmail.com>
Date: Sun, 26 Mar 2017 01:56:30 +0100
Subject: [PATCH] audioflinger: increase max tracks per uid

Fix some apps from not being able to initialize audio tracks
and prevent the following error, "AudioFlinger could not create
track. status: -12".

diff --git a/services/audioflinger/Threads.h b/services/audioflinger/Threads.h
index 0e60119..5539aad 100644
--- a/services/audioflinger/Threads.h
+++ b/services/audioflinger/Threads.h
@@ -622,8 +622,8 @@ class PlaybackThread : public ThreadBase {
     static const int8_t kMaxTrackRetriesOffload = 20;
     static const int8_t kMaxTrackStartupRetriesOffload = 100;
     static const int8_t kMaxTrackStopRetriesOffload = 2;
-    // 14 tracks max per client allows for 2 misbehaving application leaving 4 available tracks.
-    static const uint32_t kMaxTracksPerUid = 14;
+    // 40 tracks max per client allows for 2 misbehaving application leaving 8 available tracks.
+    static const uint32_t kMaxTracksPerUid = 40;
 
     // Maximum delay (in nanoseconds) for upcoming buffers in suspend mode, otherwise
     // if delay is greater, the estimated time for timeLoopNextNs is reset.
