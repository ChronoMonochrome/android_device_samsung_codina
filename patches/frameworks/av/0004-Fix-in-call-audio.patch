From a33db3688489441e29a65412fa7db806a61e45a0 Mon Sep 17 00:00:00 2001
From: Agontuk <rifat662@gmail.com>
Date: Sat, 3 Jan 2015 14:03:52 +0100
Subject: [PATCH 4/6] Fix in-call audio

Change-Id: I08f2df6276dc619ea58d72e968276aee9a0ea298
---
 services/audioflinger/AudioFlinger.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/services/audioflinger/AudioFlinger.cpp b/services/audioflinger/AudioFlinger.cpp
index 33b19a4..4b8c0ad 100644
--- a/services/audioflinger/AudioFlinger.cpp
+++ b/services/audioflinger/AudioFlinger.cpp
@@ -1538,7 +1538,11 @@ audio_io_handle_t AudioFlinger::openOutput(audio_module_handle_t module,
         thread->audioConfigChanged_l(AudioSystem::OUTPUT_OPENED);
 
         // the first primary output opened designates the primary hw device
+#ifdef STE_HARDWARE
+        if (mPrimaryHardwareDev == NULL) {
+#else
         if ((mPrimaryHardwareDev == NULL) && (flags & AUDIO_OUTPUT_FLAG_PRIMARY)) {
+#endif
             ALOGI("Using module %d has the primary audio interface", module);
             mPrimaryHardwareDev = outHwDev;
 
-- 
1.9.1

