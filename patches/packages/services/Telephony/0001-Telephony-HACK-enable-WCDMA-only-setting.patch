From b0af162c973b66e70042517f859e4670ff39de15 Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 20 Aug 2018 22:57:43 +0300
Subject: [PATCH] Telephony: HACK: enable WCDMA only setting

 Samsung stock allows WCDMA only
---
 res/values/strings.xml                           |  8 +++++---
 src/com/android/phone/MobileNetworkSettings.java | 15 +++++++++++++--
 2 files changed, 18 insertions(+), 5 deletions(-)

diff --git a/res/values/strings.xml b/res/values/strings.xml
index a565157..0e16270 100644
--- a/res/values/strings.xml
+++ b/res/values/strings.xml
@@ -715,12 +715,14 @@
     </string-array>
 
     <string-array name="enabled_networks_except_lte_choices" translatable="false">
-        <item>@string/network_3G</item>
-        <item>@string/network_2G</item>
+        <item>@string/preferred_network_mode_wcdma_only_choice</item>
+        <item>@string/preferred_network_mode_gsm_only_choice</item>
+        <item>@string/preferred_network_mode_gsm_wcdma_preferred_choice</item>
     </string-array>
     <string-array name="enabled_networks_except_lte_values" translatable="false">
-        <item>"0"</item>
+        <item>"2"</item>
         <item>"1"</item>
+        <item>"0"</item>
     </string-array>
 
     <string-array name="enabled_networks_except_gsm_lte_choices" translatable="false">
diff --git a/src/com/android/phone/MobileNetworkSettings.java b/src/com/android/phone/MobileNetworkSettings.java
index 0ea4702..1d5e533 100644
--- a/src/com/android/phone/MobileNetworkSettings.java
+++ b/src/com/android/phone/MobileNetworkSettings.java
@@ -1157,6 +1157,7 @@ public class MobileNetworkSettings extends Activity  {
                     switch (buttonNetworkMode) {
                         case Phone.NT_MODE_WCDMA_PREF:
                         case Phone.NT_MODE_GSM_ONLY:
+                        case Phone.NT_MODE_WCDMA_ONLY:
                         case Phone.NT_MODE_LTE_GSM_WCDMA:
                         case Phone.NT_MODE_LTE_CDMA_EVDO_GSM_WCDMA:
                         case Phone.NT_MODE_CDMA:
@@ -1432,12 +1433,22 @@ public class MobileNetworkSettings extends Activity  {
                     mButtonEnabledNetworks.setSummary(R.string.network_3G);
                     break;
                 case Phone.NT_MODE_WCDMA_ONLY:
+                    if (!mIsGlobalCdma) {
+                        mButtonEnabledNetworks.setValue(
+                                Integer.toString(Phone.NT_MODE_WCDMA_ONLY));
+                        mButtonEnabledNetworks.setSummary(R.string.preferred_network_mode_wcdma_only_choice);
+                    } else {
+                        mButtonEnabledNetworks.setValue(
+                                Integer.toString(Phone.NT_MODE_LTE_CDMA_EVDO_GSM_WCDMA));
+                        mButtonEnabledNetworks.setSummary(R.string.network_global);
+                    }
+                    break;
                 case Phone.NT_MODE_GSM_UMTS:
                 case Phone.NT_MODE_WCDMA_PREF:
                     if (!mIsGlobalCdma) {
                         mButtonEnabledNetworks.setValue(
                                 Integer.toString(Phone.NT_MODE_WCDMA_PREF));
-                        mButtonEnabledNetworks.setSummary(R.string.network_3G);
+                        mButtonEnabledNetworks.setSummary(R.string.preferred_network_mode_gsm_wcdma_preferred_choice);
                     } else {
                         mButtonEnabledNetworks.setValue(
                                 Integer.toString(Phone.NT_MODE_LTE_CDMA_EVDO_GSM_WCDMA));
@@ -1448,7 +1459,7 @@ public class MobileNetworkSettings extends Activity  {
                     if (!mIsGlobalCdma) {
                         mButtonEnabledNetworks.setValue(
                                 Integer.toString(Phone.NT_MODE_GSM_ONLY));
-                        mButtonEnabledNetworks.setSummary(R.string.network_2G);
+                        mButtonEnabledNetworks.setSummary(R.string.preferred_network_mode_gsm_only_choice);
                     } else {
                         mButtonEnabledNetworks.setValue(
                                 Integer.toString(Phone.NT_MODE_LTE_CDMA_EVDO_GSM_WCDMA));
-- 
2.11.0

