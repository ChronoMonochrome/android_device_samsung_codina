From 8b7b37845df12c8a1c1bb3c9aefa0b9b3009ef9b Mon Sep 17 00:00:00 2001
From: Shilin Victor <chrono.monochrome@gmail.com>
Date: Mon, 5 Sep 2016 16:47:26 +0700
Subject: [PATCH 2/3] Revert "linker: Allow text-relocs for x86 (only)"

This reverts commit 6069ffc51b195aa7c09694fd2004614e9078b677.

Change-Id: I33cb7b60b14393464790d2f4f2ea32e099c0783e
---
 linker/linker.cpp | 2 --
 1 file changed, 2 deletions(-)

diff --git a/linker/linker.cpp b/linker/linker.cpp
index b48e958..7ca4710 100644
--- a/linker/linker.cpp
+++ b/linker/linker.cpp
@@ -4060,13 +4060,11 @@ bool soinfo::link_image(const soinfo_list_t& global_group, const soinfo_list_t&
 #if !defined(__LP64__)
   if (has_text_relocations) {
     // Fail if app is targeting sdk version > 22
-#if !defined(__i386__) // ffmpeg says that they require text relocations on x86
     if (get_application_target_sdk_version() > 22) {
       PRINT("%s: has text relocations", get_realpath());
       DL_ERR("%s: has text relocations", get_realpath());
       return false;
     }
-#endif
     // Make segments writable to allow text relocations to work properly. We will later call
     // phdr_table_protect_segments() after all of them are applied.
     DL_WARN("%s has text relocations. This is wasting memory and prevents "
-- 
2.5.0

